<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Network Evolution C Library: Stochastic simulation of single cell and population of cells</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Stochastic simulation of single cell and population of cells</h1>Defines standard Gillespie stochastic simulation algorithm, which accepts propensity function and stoichiometry matrix from user.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__gillespie.html#gdd601aa1ae9fb8108adb4802c95b9b9d">cells_ssa</a> (int, int, double *, void(*f)(double, double *, double *, void *), double *, double, int, void *, int, double, double, double)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stochastic simulation with cell growth (logistic model).  <a href="#gdd601aa1ae9fb8108adb4802c95b9b9d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__gillespie.html#gdd4ed0cd866273095e5c83bbf362111e">SSA</a> (int, int, double *, void(*f)(double, double *, double *, void *), double *, double, double, int, int *, void *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stochastic simulation using Gillespie algorithm.  <a href="#gdd4ed0cd866273095e5c83bbf362111e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__gillespie.html#g63355e8ea177a2d3b07dec9a21e3535e">getRatesFromSimulatedData</a> (double *data, int rows, int cols1, int cols2, int skip, void(*f)(double, double *, double *, void *), void *param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get rates from the simulated data.  <a href="#g63355e8ea177a2d3b07dec9a21e3535e"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Defines standard Gillespie stochastic simulation algorithm, which accepts propensity function and stoichiometry matrix from user. 
<p>
Defines a simulator that performs a multi-cell stochastic simulation using a slight variant of the Gillespie algorithm.<p>
The algorithm has two levels of events (or reactions):<p>
Level 1: Cell birth and death Level 2: reactions inside each cell<p>
An overview of the algorithm:<p>
current time: t0 Calculate next time for cell birth or cell death: t1 Calculate probability of cell death and event<p>
select an event: cell birth or cell death<p>
update cell count<p>
from t0 until t1: for each cell: initialize concentrations for that cell do Gillespie simulation store final concentrations for that cell<p>
Output: all values are aligned to a grid. <hr><h2>Function Documentation</h2>
<a class="anchor" name="gdd601aa1ae9fb8108adb4802c95b9b9d"></a><!-- doxytag: member="cells_ssa.h::cells_ssa" ref="gdd601aa1ae9fb8108adb4802c95b9b9d" args="(int, int, double *, void(*f)(double, double *, double *, void *), double *, double, int, void *, int, double, double, double)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double** cells_ssa           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(double, double *, double *, void *)&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stochastic simulation with cell growth (logistic model). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of species (rows of stoichiometry matrix) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of reactions (columns of stoichiometry matrix) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double*</em>&nbsp;</td><td>stoichiometry matrix as one array, arranged as { row1, row2, row3... }, where each row is for one species </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>(*f)(time,y-values,rates)</em>&nbsp;</td><td>pointer to propensity function that assigns values to the rates array -- f(time, y-values, rates) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double*</em>&nbsp;</td><td>initial values for species </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double</em>&nbsp;</td><td>end time </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>grid size (number of data points) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>void*</em>&nbsp;</td><td>any external data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of cells </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double</em>&nbsp;</td><td>replication rate for cells </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double</em>&nbsp;</td><td>death rate for cells </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double</em>&nbsp;</td><td>percent advantage for mutants </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>double** two linearized 2D dimentional arrays: [0] cell growth data [1] concentrations data </dd></dl>

</div>
</div><p>
<a class="anchor" name="g63355e8ea177a2d3b07dec9a21e3535e"></a><!-- doxytag: member="ssa.h::getRatesFromSimulatedData" ref="g63355e8ea177a2d3b07dec9a21e3535e" args="(double *data, int rows, int cols1, int cols2, int skip, void(*f)(double, double *, double *, void *), void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* getRatesFromSimulatedData           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cols1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cols2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>skip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(double, double *, double *, void *)&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get rates from the simulated data. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>double*</em>&nbsp;</td><td>simulated data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of rows in the simulated data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of species </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of reactions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>the number of columns to skip (IMPORTANT: index starts at 1), i.e. first column is time, use 1. Use 0 for none. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>(*f)(time,y-values,rates)</em>&nbsp;</td><td>pointer to propensity function -- f(time, y-values, rates) --- assign values to the rates array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>void*</em>&nbsp;</td><td>any external data </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>double* one dimentional array -- { row1, row2...}, where each row contains {time1,x1,x2,....}. Use <a class="el" href="group__loops.html#g628cad4c6861a51348247666fb819ec4" title="Marco used to get the i,j-th value from an array with N elements: getValue(array...">getValue(y,n,i,j)</a> if needed </dd></dl>

</div>
</div><p>
<a class="anchor" name="gdd4ed0cd866273095e5c83bbf362111e"></a><!-- doxytag: member="ssa.h::SSA" ref="gdd4ed0cd866273095e5c83bbf362111e" args="(int, int, double *, void(*f)(double, double *, double *, void *), double *, double, double, int, int *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* SSA           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(double, double *, double *, void *)&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stochastic simulation using Gillespie algorithm. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of species (rows of stoichiometry matrix) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>number of reactions (columns of stoichiometry matrix) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double*</em>&nbsp;</td><td>stoichiometry matrix as one array, arranged as { row1, row2, row3... }, where each row is for one species </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>(*f)(time,y-values,rates)</em>&nbsp;</td><td>pointer to propensity function -- f(time, y-values, rates) --- assign values to the rates array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double*</em>&nbsp;</td><td>initial values for species </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double</em>&nbsp;</td><td>start time </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>double</em>&nbsp;</td><td>end time </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>max size of array to allocate (will stop even if end time is not reached) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>returns the size of the final array here </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>void*</em>&nbsp;</td><td>any external data </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>double* one dimentional array -- { row1, row2...}, where each row contains {time1,x1,x2,....}. Use <a class="el" href="group__loops.html#g628cad4c6861a51348247666fb819ec4" title="Marco used to get the i,j-th value from an array with N elements: getValue(array...">getValue(y,n,i,j)</a> if needed </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Aug 19 13:45:28 2009 for Network Evolution C Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
